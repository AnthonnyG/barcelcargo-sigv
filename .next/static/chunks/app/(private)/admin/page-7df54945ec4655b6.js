(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{17:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>_});var t=a(5155),r=a(232),l=a(2115),i=a(3540),n=a(2151),c=a(4754),d=a(6025),o=a(2071),x=a(8124),m=a(2319),h=a(7557);let p=["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"];function j(){let[e,s]=(0,l.useState)([]);(0,l.useEffect)(()=>{(async()=>{let e=await fetch("/api/stats/kms"),a=await e.json();s(p.map(e=>{let s=a.find(s=>s.mes.toLowerCase()===e);return{mes:e,km:s?s.km:0}}))})()},[]);let a=Math.max(...e.map(e=>e.km)),r=e.find(e=>e.km===a),j=new Date().getFullYear();return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("h3",{className:"text-center text-white mb-2 text-sm",children:["Evolu\xe7\xe3o de Km por M\xeas - ",j]}),(0,t.jsx)(i.u,{width:"100%",height:300,children:(0,t.jsxs)(n.b,{data:e,margin:{top:10,right:30,left:0,bottom:5},children:[(0,t.jsx)(c.d,{strokeDasharray:"3 3",stroke:"#334155"}),(0,t.jsx)(d.W,{dataKey:"mes",stroke:"#94a3b8"}),(0,t.jsx)(o.h,{stroke:"#94a3b8"}),(0,t.jsx)(x.m,{contentStyle:{backgroundColor:"#1e293b",border:"none"},labelStyle:{color:"#fff"},formatter:e=>["".concat(e," km"),"Dist\xe2ncia"]}),(0,t.jsx)(m.s,{}),(0,t.jsx)(h.N,{type:"monotone",dataKey:"km",stroke:"#22c55e",strokeWidth:2,dot:e=>{let{cx:s,cy:r,payload:l}=e;return l.km===a?(0,t.jsx)("circle",{cx:s,cy:r,r:6,fill:"#22c55e",stroke:"white",strokeWidth:2}):(0,t.jsx)("circle",{cx:s,cy:r,r:4,fill:"#22c55e"})}})]})}),r&&r.km>0&&(0,t.jsxs)("p",{className:"text-center text-sm text-lime-400 mt-2",children:["\uD83D\uDCCC M\xeas com mais quil\xf3metros: ",(0,t.jsx)("span",{className:"font-semibold",children:r.mes})," (",r.km.toLocaleString()," km)"]})]})}var g=a(7007),u=a(6422),N=a(4516),b=a(9153),f=a(8611);function y(){let[e,s]=(0,l.useState)([]);return(0,l.useEffect)(()=>{(async()=>{let e=await fetch("/api/trips/latest");s((await e.json()).map(e=>({...e,condutor:e.motorista})))})()},[]),(0,t.jsxs)("div",{className:"overflow-x-auto",children:[(0,t.jsxs)("h3",{className:"text-white text-md font-semibold flex items-center gap-2 mb-2",children:[(0,t.jsx)(g.A,{size:16})," \xdaltimas 20 Viagens"]}),(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"text-gray-400 border-b border-gray-700",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"py-2 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.A,{size:14})," Condutor"]})}),(0,t.jsx)("th",{className:"py-2 px-4",children:"Data"}),(0,t.jsx)("th",{className:"py-2 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(N.A,{size:14})," Origem"]})}),(0,t.jsx)("th",{className:"py-2 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.A,{size:14})," Destino"]})}),(0,t.jsx)("th",{className:"py-2 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(f.A,{size:14})," Km"]})})]})}),(0,t.jsxs)("tbody",{children:[e.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-[#334155] transition",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:e.condutor}),(0,t.jsx)("td",{className:"py-2 px-4",children:new Date(e.data).toLocaleDateString()}),(0,t.jsx)("td",{className:"py-2 px-4",children:e.origem}),(0,t.jsx)("td",{className:"py-2 px-4",children:e.destino}),(0,t.jsxs)("td",{className:"py-2 px-4",children:[e.km," km"]})]},e.id)),0===e.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:5,className:"py-4 text-center text-gray-500",children:"Nenhuma viagem recente encontrada."})})]})]})]})}var v=a(646),w=a(2525);function A(){let[e,s]=(0,l.useState)([]),a=async()=>{let e=await fetch("/api/users/pending");s(await e.json())};(0,l.useEffect)(()=>{a()},[]);let r=async e=>{confirm("Aprovar este utilizador?")&&(await fetch("/api/users/pending",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),a())},i=async e=>{confirm("Eliminar este utilizador?")&&(await fetch("/api/users/pending",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),a())};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-lg font-semibold text-white mb-2",children:[(0,t.jsx)(u.A,{size:20,className:"text-blue-400"}),"Utilizadores Pendentes"]}),e.map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center bg-[#0f172a] border border-gray-700 p-4 rounded-xl shadow transition hover:shadow-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-semibold flex items-center gap-2",children:[(0,t.jsx)(u.A,{size:16,className:"text-blue-400"}),e.name,(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:["(",e.role,")"]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:e.email})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>r(e.id),className:"flex items-center gap-1 bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-md text-sm",children:[(0,t.jsx)(v.A,{size:16}),"Aprovar"]}),(0,t.jsxs)("button",{onClick:()=>i(e.id),className:"flex items-center gap-1 bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-md text-sm",children:[(0,t.jsx)(w.A,{size:16}),"Eliminar"]})]})]},e.id)),0===e.length&&(0,t.jsx)("div",{className:"text-center text-gray-500 py-6 text-sm italic",children:"Nenhum utilizador pendente de aprova\xe7\xe3o."})]})}var k=a(5525),z=a(1264),E=a(6671);let S={DRIVER:"\uD83D\uDE9A Driver",MANAGER:"\uD83D\uDEE0️ Manager",ADMIN:"\uD83D\uDC51 Admin",EXPULSO:"❌ Expulso"};function D(){let[e,s]=(0,l.useState)([]);(0,l.useEffect)(()=>{a()},[]);let a=async()=>{let e=await fetch("/api/users/approved");if(!e.ok)return void console.error("Erro ao buscar usu\xe1rios aprovados");s((await e.json()).filter(e=>e.isApproved&&"EXPULSO"!==e.role))},r=async(e,s)=>{let t=localStorage.getItem("token"),r=await fetch("/api/users/approved",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({id:e,role:s})});if(!r.ok)return void alert((await r.json()).error||"Erro ao atualizar o cargo");a()},i="ADMIN"===JSON.parse(localStorage.getItem("user")||"{}").role;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-lg font-semibold text-white mb-2",children:[(0,t.jsx)(k.A,{size:20,className:"text-green-400"}),"Utilizadores Aprovados"]}),e.length>0?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm text-left border-collapse",children:[(0,t.jsx)("thead",{className:"text-gray-400 border-b border-gray-700",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"py-2 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(u.A,{size:16})," Nome"]})}),(0,t.jsx)("th",{className:"py-2 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(z.A,{size:16})," Email"]})}),(0,t.jsx)("th",{className:"py-2 px-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(k.A,{size:16})," Cargo"]})})]})}),(0,t.jsx)("tbody",{children:e.map(e=>{var s;return(0,t.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-[#334155] transition duration-150",children:[(0,t.jsx)("td",{className:"py-2 px-4",children:e.name}),(0,t.jsx)("td",{className:"py-2 px-4",children:e.email}),(0,t.jsx)("td",{className:"py-2 px-4",children:(0,t.jsx)("select",{value:e.role,onChange:s=>r(e.id,s.target.value),disabled:(s=e.role,!i&&"ADMIN"===s),className:"bg-[#1e293b] border border-gray-700 rounded px-2 py-1 w-full",children:Object.values(E.Role).map(e=>(0,t.jsx)("option",{value:e,children:S[e]||e},e))})})]},e.id)})})]})}):(0,t.jsx)("div",{className:"text-center text-gray-500 py-6 text-sm italic",children:"Nenhum utilizador aprovado dispon\xedvel."})]})}var C=a(9446),O=a(3562);function M(){let[e,s]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{(async()=>{let e=await fetch("/api/users/expelled");s(await e.json()),r(!1)})()},[]),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,t.jsx)(C.A,{size:22,className:"text-red-500"}),"Utilizadores Expulsos"]}),a?(0,t.jsx)("p",{className:"text-gray-300",children:"A carregar..."}):0===e.length?(0,t.jsx)("p",{className:"text-gray-400",children:"Nenhum utilizador expulso."}):(0,t.jsxs)("table",{className:"w-full text-sm text-left",children:[(0,t.jsx)("thead",{className:"text-gray-300 border-b border-gray-600",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"py-2 px-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(C.A,{size:16})," Nome"]})}),(0,t.jsx)("th",{className:"py-2 px-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(z.A,{size:16})," Email"]})}),(0,t.jsx)("th",{className:"py-2 px-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(O.A,{size:16})," Registado em"]})})]})}),(0,t.jsx)("tbody",{className:"text-gray-100",children:e.map(e=>(0,t.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,t.jsx)("td",{className:"py-2 px-3",children:e.name}),(0,t.jsx)("td",{className:"py-2 px-3",children:e.email}),(0,t.jsx)("td",{className:"py-2 px-3",children:new Date(e.createdAt).toLocaleDateString()})]},e.id))})]})]})}var L=a(5670),P=a(1007),T=a(7580);function I(){let[e,s]=(0,l.useState)({admins:0,managers:0,drivers:0,total:0});(0,l.useEffect)(()=>{(async()=>{let e=await fetch("/api/users/stats");s(await e.json())})()},[]);let a=[{label:"Admins",value:e.admins,icon:r.A,color:"bg-red-600"},{label:"Managers",value:e.managers,icon:L.A,color:"bg-green-600"},{label:"Drivers",value:e.drivers,icon:P.A,color:"bg-yellow-500"},{label:"Total",value:e.total,icon:T.A,color:"bg-gradient-to-br from-sky-600 to-indigo-700"}];return(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:a.map(e=>{let{label:s,value:a,icon:r,color:l}=e;return(0,t.jsxs)("div",{className:"bg-[#1e293b] rounded-2xl p-5 shadow-xl flex items-center gap-4 hover:scale-[1.02] transition",children:[(0,t.jsx)("div",{className:"".concat(l," p-3 rounded-xl shadow-md"),children:(0,t.jsx)(r,{size:26,className:"text-white drop-shadow"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-semibold text-white group-hover:text-green-400 transition",children:a}),(0,t.jsx)("p",{className:"text-gray-400 text-sm tracking-wide",children:s})]})]},s)})})}function _(){return(0,t.jsxs)("div",{className:"min-h-screen bg-[#0f172a] text-white p-6 space-y-10",children:[(0,t.jsxs)("div",{className:"flex justify-center items-center gap-3",children:[(0,t.jsx)(r.A,{size:28,className:"text-green-500"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Painel de Administra\xe7\xe3o"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-2 bg-[#1e293b] p-6 rounded-2xl shadow-lg",children:(0,t.jsx)(j,{})}),(0,t.jsx)(I,{})]}),(0,t.jsx)("div",{className:"bg-[#1e293b] p-6 rounded-2xl shadow-lg",children:(0,t.jsx)(y,{})}),(0,t.jsx)("div",{className:"bg-[#1e293b] p-6 rounded-2xl shadow-lg",children:(0,t.jsx)(A,{})}),(0,t.jsx)("div",{className:"bg-[#1e293b] p-6 rounded-2xl shadow-lg",children:(0,t.jsx)(D,{})}),(0,t.jsx)("div",{className:"bg-[#1e293b] p-6 rounded-2xl shadow-lg",children:(0,t.jsx)(M,{})})]})}},5018:(e,s,a)=>{Promise.resolve().then(a.bind(a,17))}},e=>{e.O(0,[804,441,964,358],()=>e(e.s=5018)),_N_E=e.O()}]);