generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String      @id @default(uuid())
  name        String      @unique
  email       String      @unique
  password    String
  role        Role        @default(DRIVER)
  isApproved  Boolean     @default(false)
  createdAt   DateTime    @default(now())
  avatar      String?
  socials     Json?
  medalhas    Medalha[]
  resettokens ResetToken?
  sessions    Session?
  tacas       Taca[]
  trofeus     Trofeu[]
  viagens     Viagem[]
}

model Session {
  id        String   @id @default(uuid())
  token     String   @unique
  userId    String   @unique
  expires   DateTime
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
}

model Viagem {
  id            String   @id @default(uuid())
  motoristaId   String
  camiao        String
  origem        String
  destino       String
  distancia     Int
  dano          Int
  velocidadeMax Int
  hora          DateTime
  data          DateTime @default(now())
  game          Game
  carga         String?
  lucro         String?
  motorista     User     @relation(fields: [motoristaId], references: [id])
}

model ResetToken {
  token     String   @id
  userId    String   @unique
  expires   DateTime
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
}

model Taca {
  id     String @id @default(cuid())
  userId String
  nome   String
  ano    Int
  jogo   Game
  user   User   @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
  titulo  String
}

model Medalha {
  id     String @id @default(cuid())
  userId String
  tipo   String
  ano    Int
  jogo   Game
  mes    Int
  titulo  String
  user   User   @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
}

model Trofeu {
  id     String @id @default(cuid())
  userId String
  nome   String
  descricao String
  user   User   @relation(fields: [userId], references: [id])
  tipo   String
  titulo   String
  imagem    String
}

enum Role {
  ADMIN
  MANAGER
  DRIVER
  EXPULSO
}

enum Game {
  ETS2
  ATS
}
